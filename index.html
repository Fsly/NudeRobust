<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>NudeRobust</title>
    <!-- 引用刚才更新的 CSS -->
    <link href="style.css" rel="stylesheet">
    <!-- 引用图标库 -->
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
</head>
<body>

    <!-- 1. 顶部导航栏 (悬浮在背景图上) -->
    <nav>
        <div class="nav-container">
            <!-- 左侧品牌名 -->
            <a class="nav-brand" href="index.html">Nudity Concept dataset</a>
            
            <!-- 右侧菜单链接 -->
            <div class="nav-links">
                <a href="#">Blog</a>
                <a href="explorer.html">Explorer</a>
            </div>
        </div>
    </nav>

    <!-- 2. 头部大图 (Masthead) -->
    <header class="masthead">
        <div class="overlay"></div> <!-- 黑色遮罩 -->
        <div class="nav-container"> <!-- 复用容器让文字对齐 -->
            <div class="site-heading">
                <h1>NudeRobust</h1>
                <span class="subheading">A Dataset of Robust Nudity Concept (RNC) for Erasing Concepts in Text-to-Image Models</span>
            </div>
        </div>
    </header>

    <!-- 3. 主内容区 (左右分栏布局) -->
    <div class="container">
        <div class="row">
            
            <!-- 【左边栏】介绍区域 -->
            <div class="col-left">
                <div class="intro-section">
                    <h2 class="section-heading">What is NudeRobust?</h2>
                    <p>The NudeRobust Dataset is a resource designed to erase sensitive concepts, like nudity, 
                        from text-to-image diffusion models. It provides fine-grained, real-world visual annotations that enable targeted model editing, 
                        allowing researchers to remove unwanted concepts while preserving the model's core generative capabilities. 
                        This benchmark supports the development of safer, more controllable AI image generation.
                    </p>
                    <p>It is collected by a team of <strong>immc-lab</strong> researchers at <strong>Inner Mongolia University</strong></p>

                    <p>For more details about NudeRobust, please downloaded this dataset:</p>
                    
                    <!-- 蓝色论文框 -->
                    <div class="citation-box">
                        <a class="download-box" href="nudity_train_hcojp_part1_concept.csv" download>NudeRobust: A Dataset for Erasing Concepts<br>erase nudity concepts</a>
                        <span class="sub">(Hai, Peng, Fan, et al. 2025)</span>  
                    </div>

                    <h2 class="section-heading" style="margin-top: 40px;">Example</h2>
                    <div class="Example-image">
                        <img src="head1.png">
                    </div>
                    <p>On the left is an exposed woman standing upright facing the camera, 
                        symbolizing nudity, with an arrow pointing to the right in the middle. 
                        On the right is a woman with the same features and posture but wearing clothes, 
                        representing wearing clothes or being covered. White background.</p>
                </div>
            </div>

            <!-- 【右边栏】排行榜区域 -->
            <div class="col-right">
                <div class="leaderboard-card">
                    <div class="leaderboard-header">
                        <h2>Leaderboard (Distractor Setting)</h2>
                    </div>
                    
                    <div class="leaderboard-body">
                        <p style="font-size: 14px; margin-bottom: 20px; color: #666;">
                            In the <i>distractor</i> setting, a question-answering system reads 10 paragraphs to provide an answer (Ans) to a question. They must also justify these answers with supporting facts (Sup).
                        </p>

                        <table id="csv-data-body">
                            <thead id="dynamic-thead"></thead>
                            <tbody id="dynamic-tbody"></tbody>
                            </thead>
                        </table>
                        <div class="pagination-container">
                            <button id="prevBtn" class="pagination-btn">Previous</button>
                            <span id="pageInfo" class="page-info">Page 1 of 1</span>
                            <button id="nextBtn" class="pagination-btn">Next</button>
                        </div>
                    </div>
                </div>
            </div>

        </div> <!-- row 结束 -->
    </div> <!-- container 结束 -->

    <!-- 页脚 -->
    <footer style="text-align: center; padding: 40px; margin-top: 40px; border-top: 1px solid #eee; color: #999;">
        <p>Copyright &copy; HotpotQA Team 2025</p>
    </footer>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // === 配置 ===
        const CSV_FILE = './nudity_train_hcojp_part1_concept.csv';
        const ROWS_PER_PAGE = 10;
        
        let currentPage = 1;
        let allDataRows = [];
        let headers = [];

        // 绑定按钮
        document.getElementById('prevBtn').addEventListener('click', () => changePage(-1));
        document.getElementById('nextBtn').addEventListener('click', () => changePage(1));

        // 加载数据
        fetch(CSV_FILE)
            .then(res => {
                if (!res.ok) throw new Error("文件加载失败: " + res.status);
                return res.text();
            })
            .then(text => {
                const lines = text.trim().split('\n');
                if (lines.length < 2) return;

                // 1. 解析表头 (第一行)
                // 也要用 parseCSVLine，防止表头里有逗号
                headers = parseCSVLine(lines[0]);

                // 2. 生成表头 HTML (通用模式)
                let theadHtml = '<tr>';
                headers.forEach(h => {
                    theadHtml += `<th>${h}</th>`;
                });
                theadHtml += '</tr>';
                document.getElementById('dynamic-thead').innerHTML = theadHtml;

                // 3. 解析所有数据行
                // 从第1行开始解析
                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim()) {
                        // 使用智能解析函数，而不是 split(',')
                        const rowData = parseCSVLine(lines[i]);
                        allDataRows.push(rowData);
                    }
                }

                // 4. 渲染第一页
                renderTable(currentPage);
            })
            .catch(err => {
                console.error(err);
                document.querySelector('.table-wrapper').innerHTML = `<div style="padding:20px;text-align:center;color:red;">无法读取 CSV 文件，请确保文件存在且未跨域。<br>错误信息: ${err.message}</div>`;
            });

        // === 核心：智能 CSV 解析函数 (解决逗号分割问题) ===
        function parseCSVLine(text) {
            const result = [];
            let current = '';
            let inQuote = false;
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                
                if (inQuote) {
                    if (char === '"') {
                        // 如果下一个也是引号，说明是转义 (Excel标准: "")
                        if (i + 1 < text.length && text[i + 1] === '"') {
                            current += '"';
                            i++; // 跳过下一个引号
                        } else {
                            inQuote = false; // 结束引号
                        }
                    } else {
                        current += char;
                    }
                } else {
                    if (char === '"') {
                        inQuote = true; // 开始引号
                    } else if (char === ',') {
                        result.push(current.trim()); // 遇到逗号，保存当前字段
                        current = '';
                    } else {
                        current += char;
                    }
                }
            }
            // 保存最后一个字段
            result.push(current.trim());
            return result;
        }

        // === 渲染表格 ===
        function renderTable(page) {
            const tbody = document.getElementById('dynamic-tbody');
            tbody.innerHTML = '';

            const start = (page - 1) * ROWS_PER_PAGE;
            const end = start + ROWS_PER_PAGE;
            const pageData = allDataRows.slice(start, end);

            let html = '';
            pageData.forEach(cols => {
                html += '<tr>';
                // 遍历每一列数据生成 td
                // 如果当前行数据列数少于表头，自动补空
                for (let i = 0; i < headers.length; i++) {
                    let cellData = cols[i] || ''; 
                    // 简单的内容截断，防止文字太多撑爆屏幕
                    if (cellData.length > 200) {
                        cellData = cellData.substring(0, 200) + '...';
                    }
                    html += `<td>${cellData}</td>`;
                }
                html += '</tr>';
            });
            tbody.innerHTML = html;
            updateControls();
        }

        // === 更新分页按钮 ===
        function updateControls() {
            const totalPages = Math.ceil(allDataRows.length / ROWS_PER_PAGE) || 1;
            document.getElementById('pageInfo').innerText = `Page ${currentPage} of ${totalPages}`;
            document.getElementById('prevBtn').disabled = (currentPage === 1);
            document.getElementById('nextBtn').disabled = (currentPage >= totalPages);
        }

        function changePage(dir) {
            currentPage += dir;
            renderTable(currentPage);
        }
    });
    </script>
</body>
</html>
